{"version":3,"file":"rnode-websocket-client.iife.js","sources":["../src/logger.ts","../src/client.ts","../src/index.ts"],"sourcesContent":["export enum LogLevel {\n  TRACE = 0,\n  DEBUG = 1,\n  INFO = 2,\n  WARN = 3,\n  ERROR = 4\n}\n\nexport class Logger {\n  private level: LogLevel = LogLevel.INFO;\n  private prefix: string = 'rnode-websocket-client';\n\n  constructor(level?: LogLevel, prefix?: string) {\n    if (level !== undefined) this.level = level;\n    if (prefix !== undefined) this.prefix = prefix;\n  }\n\n  setLevel(level: LogLevel): void {\n    this.level = level;\n  }\n\n  private shouldLog(level: LogLevel): boolean {\n    return level >= this.level;\n  }\n\n  private formatMessage(level: string, message: string, context?: string): string {\n    const timestamp = new Date().toISOString();\n    const contextStr = context ? ` [${context}]` : '';\n    return `[${timestamp}] ${level.toUpperCase()} ${this.prefix}${contextStr}: ${message}`;\n  }\n\n  trace(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.TRACE)) {\n      console.trace(this.formatMessage('TRACE', message, context));\n    }\n  }\n\n  debug(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      console.debug(this.formatMessage('DEBUG', message, context));\n    }\n  }\n\n  info(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.INFO)) {\n      console.info(this.formatMessage('INFO', message, context));\n    }\n  }\n\n  warn(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.WARN)) {\n      console.warn(this.formatMessage('WARN', message, context));\n    }\n  }\n\n  error(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.ERROR)) {\n      console.error(this.formatMessage('ERROR', message, context));\n    }\n  }\n}\n\nexport const logger = new Logger();\n","import { WebSocketOptions, WebSocketEvent, WebSocketMessage, RoomInfo, ConnectionInfo, ReconnectConfig, PingPongConfig } from './types';\nimport { logger } from './logger';\n\nexport class RNodeWebSocketClient {\n  private ws: WebSocket | null = null;\n  private options: WebSocketOptions;\n  private reconnectConfig: ReconnectConfig;\n  private pingPongConfig: PingPongConfig;\n  private reconnectTimer: NodeJS.Timeout | null = null;\n  private pingTimer: NodeJS.Timeout | null = null;\n  private pongTimer: NodeJS.Timeout | null = null;\n  private isConnecting: boolean = false;\n  private isReconnecting: boolean = false;\n  private currentRoom: string | null = null;\n  \n  // –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π\n  private eventListeners: Map<string, Function[]> = new Map();\n\n  constructor(options: WebSocketOptions) {\n    this.options = {\n      autoReconnect: true,\n      reconnectAttempts: 5,\n      reconnectDelay: 1000,\n      pingInterval: 30000,\n      pongTimeout: 10000,\n      ...options\n    };\n\n    this.reconnectConfig = {\n      enabled: this.options.autoReconnect!,\n      interval: this.options.reconnectDelay!,\n      maxAttempts: this.options.reconnectAttempts!,\n      currentAttempt: 0\n    };\n\n    this.pingPongConfig = {\n      enabled: true,\n      interval: this.options.pingInterval!,\n      timeout: this.options.pongTimeout!,\n      lastPing: 0,\n      lastPong: 0\n    };\n\n    logger.info('üîå RNode WebSocket Client initialized', 'client');\n  }\n\n  /**\n   * –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è\n   */\n  on(event: string, listener: Function): void {\n    if (!this.eventListeners.has(event)) {\n      this.eventListeners.set(event, []);\n    }\n    this.eventListeners.get(event)!.push(listener);\n  }\n\n  /**\n   * –û—Ç–ø–∏—Å–∫–∞ –æ—Ç —Å–æ–±—ã—Ç–∏–π\n   */\n  off(event: string, listener: Function): void {\n    if (this.eventListeners.has(event)) {\n      const listeners = this.eventListeners.get(event)!;\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n    }\n  }\n\n  /**\n   * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π\n   */\n  private emit(event: string, data?: any): void {\n    if (this.eventListeners.has(event)) {\n      const listeners = this.eventListeners.get(event)!;\n      listeners.forEach(listener => {\n        try {\n          listener(data);\n        } catch (error) {\n          logger.error(`‚ùå Error in event listener for ${event}: ${error}`, 'client');\n        }\n      });\n    }\n  }\n\n  /**\n   * –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É\n   */\n  connect(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n        resolve();\n        return;\n      }\n\n      if (this.isConnecting) {\n        reject(new Error('Connection already in progress'));\n        return;\n      }\n\n      this.isConnecting = true;\n      \n      // –§–æ—Ä–º–∏—Ä—É–µ–º URL —Å clientId –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å\n      let connectionUrl = this.options.url;\n      if (this.options.clientId) {\n        const separator = connectionUrl.includes('?') ? '&' : '?';\n        connectionUrl = `${connectionUrl}${separator}clientId=${encodeURIComponent(this.options.clientId)}`;\n      }\n      \n      logger.info(`üîå Connecting to ${connectionUrl}`, 'client');\n\n      try {\n        this.ws = new WebSocket(connectionUrl, this.options.protocols);\n        this.setupEventHandlers(resolve, reject);\n      } catch (error) {\n        this.isConnecting = false;\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π WebSocket\n   */\n  private setupEventHandlers(resolve: () => void, reject: (error: Error) => void): void {\n    if (!this.ws) return;\n\n    this.ws.onopen = () => {\n      this.isConnecting = false;\n      this.isReconnecting = false;\n      this.reconnectConfig.currentAttempt = 0;\n      \n      logger.info('‚úÖ WebSocket connected', 'client');\n      \n      // –ó–∞–ø—É—Å–∫–∞–µ–º ping/pong\n      this.startPingPong();\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ connect\n      this.emit('connect', {\n        url: this.options.url,\n        clientId: this.options.clientId,\n        timestamp: Date.now()\n      });\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onConnect) {\n        const wsEvent: WebSocketEvent = {\n          type: 'connect',\n          data: { url: this.options.url, clientId: this.options.clientId },\n          timestamp: Date.now()\n        };\n        this.options.onConnect(wsEvent);\n      }\n      \n      resolve();\n    };\n\n    this.ws.onclose = (event) => {\n      this.isConnecting = false;\n      this.stopPingPong();\n      \n      logger.warn(`üîå WebSocket closed: ${event.code} ${event.reason}`, 'client');\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onDisconnect) {\n        const wsEvent: WebSocketEvent = {\n          type: 'disconnect',\n          data: { code: event.code, reason: event.reason, wasClean: event.wasClean },\n          timestamp: Date.now()\n        };\n        this.options.onDisconnect(wsEvent);\n      }\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ disconnect\n      this.emit('disconnect', {\n        code: event.code,\n        reason: event.reason,\n        wasClean: event.wasClean,\n        timestamp: Date.now()\n      });\n      \n      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ\n      if (this.reconnectConfig.enabled && !this.isReconnecting) {\n        this.scheduleReconnect();\n      }\n    };\n\n    this.ws.onmessage = (event) => {\n      try {\n        const message: WebSocketMessage = JSON.parse(event.data);\n        logger.debug(`üì® Message received: ${message.type}`, 'client');\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ welcome —Å–æ–æ–±—â–µ–Ω–∏—è\n        if (message.type === 'welcome') {\n          logger.info('üëã Welcome message received', 'client');\n          this.emit('welcome', message as any);\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n          if (this.options.onWelcome) {\n            this.options.onWelcome(message as any);\n          }\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ ping/pong\n        if (message.type === 'ping') {\n          logger.info('üèì Ping received from server', 'client');\n          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º pong –≤ –æ—Ç–≤–µ—Ç\n          this.sendPong();\n          return;\n        }\n        \n        if (message.type === 'pong') {\n          this.handlePong();\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∫–æ–º–Ω–∞—Ç–∞—Ö –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n        if (message.type === 'room_joined') {\n          logger.info('üè† Room joined message received', 'client');\n          this.emit('join_room', { roomId: message.room_id, timestamp: Date.now() });\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n          if (this.options.onJoinRoom) {\n            this.options.onJoinRoom({ roomId: message.room_id, timestamp: Date.now() });\n          }\n          return;\n        }\n        \n        if (message.type === 'room_left') {\n          logger.info('üö™ Room left message received', 'client');\n          this.emit('leave_room', { roomId: message.room_id, timestamp: Date.now() });\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n          if (this.options.onLeaveRoom) {\n            this.options.onLeaveRoom({ roomId: message.room_id, timestamp: Date.now() });\n          }\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–º–Ω–∞—Ç–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n        if (message.type === 'room_message') {\n          logger.info('üì® Room message received', 'client');\n          this.emit('message', message);\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–º–Ω–∞—Ç–µ\n          if (this.options.onRoomMessage) {\n            this.options.onRoomMessage(message as any);\n          }\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n        if (message.type === 'message_ack') {\n          logger.info('‚úÖ Message acknowledgment received', 'client');\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n          if (this.options.onMessageAck) {\n            this.options.onMessageAck(message as any);\n          }\n          \n          // –ù–µ –≤—ã–∑—ã–≤–∞–µ–º onMessage –¥–ª—è —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä—è–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n        if (message.type === 'direct_message') {\n          logger.info('üì® Direct message received', 'client');\n          this.emit('message', message);\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—Ä—è–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n          if (this.options.onDirectMessage) {\n            this.options.onDirectMessage(message as any);\n          }\n          return;\n        }\n        \n        // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n        if (this.options.onMessage) {\n          const wsEvent: WebSocketEvent = {\n            type: 'message',\n            data: message,\n            timestamp: Date.now()\n          };\n          this.options.onMessage(wsEvent);\n        }\n        \n        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ message\n        this.emit('message', message);\n      } catch (error) {\n        logger.error(`‚ùå Error parsing message: ${error}`, 'client');\n      }\n    };\n\n    this.ws.onerror = (error) => {\n      this.isConnecting = false;\n      logger.error(`‚ùå WebSocket error: ${error}`, 'client');\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onError) {\n        const wsEvent: WebSocketEvent = {\n          type: 'error',\n          data: { error: error.toString() },\n          timestamp: Date.now()\n        };\n        this.options.onError(wsEvent);\n      }\n      \n      reject(new Error(`WebSocket connection failed: ${error}`));\n    };\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è\n   */\n  send(data: any, roomId?: string): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    try {\n      const message: WebSocketMessage = {\n        type: 'message',\n        data,\n        timestamp: new Date().toISOString(),\n        roomId: roomId || this.currentRoom || undefined\n      };\n\n      this.ws.send(JSON.stringify(message));\n      logger.debug(`üì§ Message sent: ${JSON.stringify(data).substring(0, 100)}...`, 'client');\n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error sending message: ${error}`, 'client');\n      return false;\n    }\n  }\n\n  /**\n   * –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ\n   */\n  joinRoom(roomId: string): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    try {\n      const message: WebSocketMessage = {\n        type: 'join_room',\n        data: { roomId },\n        timestamp: new Date().toISOString()\n      };\n\n      this.ws.send(JSON.stringify(message));\n      this.currentRoom = roomId;\n      \n      logger.info(`üîó Joined room: ${roomId}`, 'client');\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ\n      this.emit('join_room', { roomId, timestamp: Date.now() });\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onJoinRoom) {\n        this.options.onJoinRoom({ roomId, timestamp: Date.now() });\n      }\n      \n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error joining room: ${error}`, 'client');\n      return false;\n    }\n  }\n\n  /**\n   * –í—ã—Ö–æ–¥ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã\n   */\n  leaveRoom(roomId?: string): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    const targetRoom = roomId || this.currentRoom;\n    if (!targetRoom) {\n      logger.warn('‚ö†Ô∏è Not in any room', 'client');\n      return false;\n    }\n\n    try {\n      const message: WebSocketMessage = {\n        type: 'leave_room',\n        data: { roomId: targetRoom },\n        timestamp: new Date().toISOString()\n      };\n\n      this.ws.send(JSON.stringify(message));\n      \n      if (targetRoom === this.currentRoom) {\n        this.currentRoom = null;\n      }\n      \n      logger.info(`üö™ Left room: ${targetRoom}`, 'client');\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ\n      this.emit('leave_room', { roomId: targetRoom, timestamp: Date.now() });\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onLeaveRoom) {\n        this.options.onLeaveRoom({ roomId: targetRoom, timestamp: Date.now() });\n      }\n      \n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error leaving room: ${error}`, 'client');\n      return false;\n    }\n  }\n\n  /**\n   * –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n   */\n  disconnect(): void {\n    logger.info('üîå Disconnecting from WebSocket server', 'client');\n    \n    this.stopPingPong();\n    this.cancelReconnect();\n    \n    if (this.ws) {\n      this.ws.close(1000, 'Client disconnect');\n      this.ws = null;\n    }\n    \n    this.isConnecting = false;\n    this.isReconnecting = false;\n    this.currentRoom = null;\n  }\n\n  /**\n   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n   */\n  getState(): number {\n    return this.ws ? this.ws.readyState : WebSocket.CLOSED;\n  }\n\n  /**\n   * –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n   */\n  isConnected(): boolean {\n    return this.ws ? this.ws.readyState === WebSocket.OPEN : false;\n  }\n\n  /**\n   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–º–Ω–∞—Ç—ã\n   */\n  getCurrentRoom(): string | null {\n    return this.currentRoom;\n  }\n\n  /**\n   * –ó–∞–ø—É—Å–∫ ping/pong –º–µ—Ö–∞–Ω–∏–∑–º–∞\n   */\n  private startPingPong(): void {\n    if (!this.pingPongConfig.enabled) return;\n    \n    this.pingTimer = setInterval(() => {\n      this.sendPing();\n    }, this.pingPongConfig.interval);\n  }\n\n  /**\n   * –û—Å—Ç–∞–Ω–æ–≤–∫–∞ ping/pong –º–µ—Ö–∞–Ω–∏–∑–º–∞\n   */\n  private stopPingPong(): void {\n    if (this.pingTimer) {\n      clearInterval(this.pingTimer);\n      this.pingTimer = null;\n    }\n    \n    if (this.pongTimer) {\n      clearTimeout(this.pongTimer);\n      this.pongTimer = null;\n    }\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ ping\n   */\n  private sendPing(): void {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) return;\n    \n    try {\n      const pingMessage: WebSocketMessage = {\n        type: 'ping',\n        data: { timestamp: new Date().toISOString() },\n        timestamp: new Date().toISOString()\n      };\n      \n      this.ws.send(JSON.stringify(pingMessage));\n      this.pingPongConfig.lastPing = Date.now();\n      \n      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç –¥–ª—è pong\n      this.pongTimer = setTimeout(() => {\n        logger.warn('‚ö†Ô∏è Pong timeout, connection may be stale', 'client');\n        this.ws?.close(1000, 'Pong timeout');\n      }, this.pingPongConfig.timeout);\n      \n      logger.debug('üèì Ping sent', 'client');\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ ping\n      this.emit('ping', { timestamp: this.pingPongConfig.lastPing });\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onPing) {\n        this.options.onPing({ timestamp: this.pingPongConfig.lastPing });\n      }\n    } catch (error) {\n      logger.error(`‚ùå Error sending ping: ${error}`, 'client');\n    }\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ pong –≤ –æ—Ç–≤–µ—Ç –Ω–∞ ping –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n   */\n  private sendPong(): void {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) return;\n    \n    try {\n      const pongMessage: WebSocketMessage = {\n        type: 'pong',\n        data: { timestamp: new Date().toISOString() },\n        timestamp: new Date().toISOString()\n      };\n      \n      this.ws.send(JSON.stringify(pongMessage));\n      logger.debug('üèì Pong sent to server', 'client');\n    } catch (error) {\n      logger.error(`‚ùå Error sending pong: ${error}`, 'client');\n    }\n  }\n\n  /**\n   * –û–±—Ä–∞–±–æ—Ç–∫–∞ pong\n   */\n  private handlePong(): void {\n    this.pingPongConfig.lastPong = Date.now();\n    \n    if (this.pongTimer) {\n      clearTimeout(this.pongTimer);\n      this.pongTimer = null;\n    }\n    \n    const latency = this.pingPongConfig.lastPong - this.pingPongConfig.lastPing;\n    logger.debug(`üèì Pong received, latency: ${latency}ms`, 'client');\n    \n    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ pong\n    this.emit('pong', { latency, timestamp: this.pingPongConfig.lastPong });\n    \n    // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n    if (this.options.onPong) {\n      this.options.onPong({ latency, timestamp: this.pingPongConfig.lastPong });\n    }\n  }\n\n  /**\n   * –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n   */\n  private scheduleReconnect(): void {\n    if (this.reconnectConfig.currentAttempt >= this.reconnectConfig.maxAttempts) {\n      logger.error(`‚ùå Max reconnection attempts reached (${this.reconnectConfig.maxAttempts})`, `client`);\n      return;\n    }\n    \n    this.isReconnecting = true;\n    this.reconnectConfig.currentAttempt++;\n    \n    const delay = this.reconnectConfig.interval * Math.pow(2, this.reconnectConfig.currentAttempt - 1);\n    logger.info(`üîÑ Reconnecting in ${delay}ms (attempt ${this.reconnectConfig.currentAttempt}/${this.reconnectConfig.maxAttempts})`, 'client');\n    \n    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ reconnect\n    this.emit('reconnect', {\n      attempt: this.reconnectConfig.currentAttempt,\n      maxAttempts: this.reconnectConfig.maxAttempts,\n      delay,\n      timestamp: Date.now()\n    });\n    \n    // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n    if (this.options.onReconnect) {\n      this.options.onReconnect({\n        attempt: this.reconnectConfig.currentAttempt,\n        maxAttempts: this.reconnectConfig.maxAttempts,\n        delay,\n        timestamp: Date.now()\n      });\n    }\n    \n    this.reconnectTimer = setTimeout(() => {\n      this.connect().catch((error) => {\n        logger.error(`‚ùå Reconnection failed: ${error}`, 'client');\n        this.scheduleReconnect();\n      });\n    }, delay);\n  }\n\n  /**\n   * –û—Ç–º–µ–Ω–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n   */\n  private cancelReconnect(): void {\n    if (this.reconnectTimer) {\n      clearTimeout(this.reconnectTimer);\n      this.reconnectTimer = null;\n    }\n    this.isReconnecting = false;\n  }\n\n  /**\n   * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏\n   */\n  updateOptions(newOptions: Partial<WebSocketOptions>): void {\n    this.options = { ...this.options, ...newOptions };\n    \n    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n    if (newOptions.autoReconnect !== undefined) {\n      this.reconnectConfig.enabled = newOptions.autoReconnect;\n    }\n    if (newOptions.reconnectAttempts !== undefined) {\n      this.reconnectConfig.maxAttempts = newOptions.reconnectAttempts;\n    }\n    if (newOptions.reconnectDelay !== undefined) {\n      this.reconnectConfig.interval = newOptions.reconnectDelay;\n    }\n    \n    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é ping/pong\n    if (newOptions.pingInterval !== undefined) {\n      this.pingPongConfig.interval = newOptions.pingInterval;\n    }\n    if (newOptions.pongTimeout !== undefined) {\n      this.pingPongConfig.timeout = newOptions.pongTimeout;\n    }\n    \n    logger.info('üîß WebSocket options updated', 'client');\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–æ–º–Ω–∞—Ç—É\n   */\n  sendToRoom(roomId: string, message: any): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    try {\n      const wsMessage: WebSocketMessage = {\n        type: 'room_message',\n        data: message,\n        timestamp: new Date().toISOString(),\n        roomId: roomId\n      };\n\n      this.ws.send(JSON.stringify(wsMessage));\n      logger.debug(`üì§ Room message sent to ${roomId}: ${JSON.stringify(message).substring(0, 100)}...`, 'client');\n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error sending room message: ${error}`, 'client');\n      return false;\n    }\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä—è–º–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—É –ø–æ ID\n   */\n  sendDirectMessage(clientId: string, message: any): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    try {\n      const wsMessage: WebSocketMessage = {\n        type: 'direct_message',\n        data: message,\n        timestamp: new Date().toISOString(),\n        targetClientId: clientId\n      };\n\n      this.ws.send(JSON.stringify(wsMessage));\n      logger.debug(`üì§ Direct message sent to client ${clientId}: ${message}`, 'client');\n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error sending direct message: ${error}`, 'client');\n      return false;\n    }\n  }\n}\n","import { RNodeWebSocketClient } from './client';\nimport { Logger, LogLevel } from './logger';\nimport type {\n  WebSocketOptions,\n  WebSocketEvent,\n  WebSocketMessage,\n  RoomInfo,\n  ConnectionInfo,\n  ReconnectConfig,\n  PingPongConfig\n} from './types';\n\n// –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\nexport function createWebSocketClient(options: WebSocketOptions) {\n  return new RNodeWebSocketClient(options);\n}\n\n// –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å WebSocket\nexport const WebSocketUtils = {\n  /**\n   * –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ WebSocket –≤ –±—Ä–∞—É–∑–µ—Ä–µ\n   */\n  isSupported(): boolean {\n    return typeof WebSocket !== 'undefined';\n  },\n\n  /**\n   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ\n   */\n  getStateString(state: number): string {\n    switch (state) {\n      case WebSocket.CONNECTING:\n        return 'CONNECTING';\n      case WebSocket.OPEN:\n        return 'OPEN';\n      case WebSocket.CLOSING:\n        return 'CLOSING';\n      case WebSocket.CLOSED:\n        return 'CLOSED';\n      default:\n        return 'UNKNOWN';\n    }\n  },\n\n  /**\n   * –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞\n   */\n  generateClientId(): string {\n    return `client_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  },\n\n  /**\n   * –í–∞–ª–∏–¥–∞—Ü–∏—è URL WebSocket\n   */\n  isValidUrl(url: string): boolean {\n    try {\n      const urlObj = new URL(url);\n      return urlObj.protocol === 'ws:' || urlObj.protocol === 'wss:';\n    } catch {\n      return false;\n    }\n  }\n};\n\n// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ\nif (typeof window !== 'undefined') {\n  // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å WebSocket –∫–ª–∏–µ–Ω—Ç–∞ - —É–±–∏—Ä–∞–µ–º –¥–≤–æ–π–Ω—É—é –æ–±–µ—Ä—Ç–∫—É\n  (window as any).RNodeWebSocketClient = RNodeWebSocketClient;\n  \n  // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞\n  (window as any).createWebSocketClient = createWebSocketClient;\n  \n  // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã\n  (window as any).WebSocketUtils = WebSocketUtils;\n  \n  // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ª–æ–≥–≥–µ—Ä\n  (window as any).WebSocketLogger = Logger;\n  (window as any).WebSocketLogLevel = LogLevel;\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∞—Å—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä\n  console.log('üîå RNode WebSocket Client –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ');\n  console.log('üìñ –î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:');\n  console.log('   - window.RNodeWebSocketClient:', typeof (window as any).RNodeWebSocketClient);\n  console.log('   - window.createWebSocketClient():', typeof (window as any).createWebSocketClient);\n  console.log('   - window.WebSocketUtils:', typeof (window as any).WebSocketUtils);\n  console.log('   - window.WebSocketLogger:', typeof (window as any).WebSocketLogger);\n  \n  // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞\n  try {\n    const testClient = new (window as any).RNodeWebSocketClient({ url: 'ws://test' });\n    console.log('‚úÖ RNodeWebSocketClient —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∫–∞–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä');\n  } catch (error) {\n    console.error('‚ùå RNodeWebSocketClient –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º:', error);\n  }\n}\n\n// –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –º–æ–¥—É–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º\nexport {\n  RNodeWebSocketClient,\n  Logger,\n  LogLevel\n};\n"],"names":["LogLevel"],"mappings":"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"}