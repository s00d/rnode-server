{"version":3,"file":"rnode-websocket-client.es.js","sources":["../src/logger.ts","../src/client.ts","../src/index.ts"],"sourcesContent":["export enum LogLevel {\n  TRACE = 0,\n  DEBUG = 1,\n  INFO = 2,\n  WARN = 3,\n  ERROR = 4\n}\n\nexport class Logger {\n  private level: LogLevel = LogLevel.INFO;\n  private prefix: string = 'rnode-websocket-client';\n\n  constructor(level?: LogLevel, prefix?: string) {\n    if (level !== undefined) this.level = level;\n    if (prefix !== undefined) this.prefix = prefix;\n  }\n\n  setLevel(level: LogLevel): void {\n    this.level = level;\n  }\n\n  private shouldLog(level: LogLevel): boolean {\n    return level >= this.level;\n  }\n\n  private formatMessage(level: string, message: string, context?: string): string {\n    const timestamp = new Date().toISOString();\n    const contextStr = context ? ` [${context}]` : '';\n    return `[${timestamp}] ${level.toUpperCase()} ${this.prefix}${contextStr}: ${message}`;\n  }\n\n  trace(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.TRACE)) {\n      console.trace(this.formatMessage('TRACE', message, context));\n    }\n  }\n\n  debug(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.DEBUG)) {\n      console.debug(this.formatMessage('DEBUG', message, context));\n    }\n  }\n\n  info(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.INFO)) {\n      console.info(this.formatMessage('INFO', message, context));\n    }\n  }\n\n  warn(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.WARN)) {\n      console.warn(this.formatMessage('WARN', message, context));\n    }\n  }\n\n  error(message: string, context?: string): void {\n    if (this.shouldLog(LogLevel.ERROR)) {\n      console.error(this.formatMessage('ERROR', message, context));\n    }\n  }\n}\n\nexport const logger = new Logger();\n","import { WebSocketOptions, WebSocketEvent, WebSocketMessage, RoomInfo, ConnectionInfo, ReconnectConfig, PingPongConfig } from './types';\nimport { logger } from './logger';\n\nexport class RNodeWebSocketClient {\n  private ws: WebSocket | null = null;\n  private options: WebSocketOptions;\n  private reconnectConfig: ReconnectConfig;\n  private pingPongConfig: PingPongConfig;\n  private reconnectTimer: NodeJS.Timeout | null = null;\n  private pingTimer: NodeJS.Timeout | null = null;\n  private pongTimer: NodeJS.Timeout | null = null;\n  private isConnecting: boolean = false;\n  private isReconnecting: boolean = false;\n  private currentRoom: string | null = null;\n  \n  // –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π\n  private eventListeners: Map<string, Function[]> = new Map();\n\n  constructor(options: WebSocketOptions) {\n    this.options = {\n      autoReconnect: true,\n      reconnectAttempts: 5,\n      reconnectDelay: 1000,\n      pingInterval: 30000,\n      pongTimeout: 10000,\n      ...options\n    };\n\n    this.reconnectConfig = {\n      enabled: this.options.autoReconnect!,\n      interval: this.options.reconnectDelay!,\n      maxAttempts: this.options.reconnectAttempts!,\n      currentAttempt: 0\n    };\n\n    this.pingPongConfig = {\n      enabled: true,\n      interval: this.options.pingInterval!,\n      timeout: this.options.pongTimeout!,\n      lastPing: 0,\n      lastPong: 0\n    };\n\n    logger.info('üîå RNode WebSocket Client initialized', 'client');\n  }\n\n  /**\n   * –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è\n   */\n  on(event: string, listener: Function): void {\n    if (!this.eventListeners.has(event)) {\n      this.eventListeners.set(event, []);\n    }\n    this.eventListeners.get(event)!.push(listener);\n  }\n\n  /**\n   * –û—Ç–ø–∏—Å–∫–∞ –æ—Ç —Å–æ–±—ã—Ç–∏–π\n   */\n  off(event: string, listener: Function): void {\n    if (this.eventListeners.has(event)) {\n      const listeners = this.eventListeners.get(event)!;\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n    }\n  }\n\n  /**\n   * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π\n   */\n  private emit(event: string, data?: any): void {\n    if (this.eventListeners.has(event)) {\n      const listeners = this.eventListeners.get(event)!;\n      listeners.forEach(listener => {\n        try {\n          listener(data);\n        } catch (error) {\n          logger.error(`‚ùå Error in event listener for ${event}: ${error}`, 'client');\n        }\n      });\n    }\n  }\n\n  /**\n   * –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É\n   */\n  connect(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n        resolve();\n        return;\n      }\n\n      if (this.isConnecting) {\n        reject(new Error('Connection already in progress'));\n        return;\n      }\n\n      this.isConnecting = true;\n      \n      // –§–æ—Ä–º–∏—Ä—É–µ–º URL —Å clientId –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å\n      let connectionUrl = this.options.url;\n      if (this.options.clientId) {\n        const separator = connectionUrl.includes('?') ? '&' : '?';\n        connectionUrl = `${connectionUrl}${separator}clientId=${encodeURIComponent(this.options.clientId)}`;\n      }\n      \n      logger.info(`üîå Connecting to ${connectionUrl}`, 'client');\n\n      try {\n        this.ws = new WebSocket(connectionUrl, this.options.protocols);\n        this.setupEventHandlers(resolve, reject);\n      } catch (error) {\n        this.isConnecting = false;\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π WebSocket\n   */\n  private setupEventHandlers(resolve: () => void, reject: (error: Error) => void): void {\n    if (!this.ws) return;\n\n    this.ws.onopen = () => {\n      this.isConnecting = false;\n      this.isReconnecting = false;\n      this.reconnectConfig.currentAttempt = 0;\n      \n      logger.info('‚úÖ WebSocket connected', 'client');\n      \n      // –ó–∞–ø—É—Å–∫–∞–µ–º ping/pong\n      this.startPingPong();\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ connect\n      this.emit('connect', {\n        url: this.options.url,\n        clientId: this.options.clientId,\n        timestamp: Date.now()\n      });\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onConnect) {\n        const wsEvent: WebSocketEvent = {\n          type: 'connect',\n          data: { url: this.options.url, clientId: this.options.clientId },\n          timestamp: Date.now()\n        };\n        this.options.onConnect(wsEvent);\n      }\n      \n      resolve();\n    };\n\n    this.ws.onclose = (event) => {\n      this.isConnecting = false;\n      this.stopPingPong();\n      \n      logger.warn(`üîå WebSocket closed: ${event.code} ${event.reason}`, 'client');\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onDisconnect) {\n        const wsEvent: WebSocketEvent = {\n          type: 'disconnect',\n          data: { code: event.code, reason: event.reason, wasClean: event.wasClean },\n          timestamp: Date.now()\n        };\n        this.options.onDisconnect(wsEvent);\n      }\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ disconnect\n      this.emit('disconnect', {\n        code: event.code,\n        reason: event.reason,\n        wasClean: event.wasClean,\n        timestamp: Date.now()\n      });\n      \n      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ\n      if (this.reconnectConfig.enabled && !this.isReconnecting) {\n        this.scheduleReconnect();\n      }\n    };\n\n    this.ws.onmessage = (event) => {\n      try {\n        const message: WebSocketMessage = JSON.parse(event.data);\n        logger.debug(`üì® Message received: ${message.type}`, 'client');\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ welcome —Å–æ–æ–±—â–µ–Ω–∏—è\n        if (message.type === 'welcome') {\n          logger.info('üëã Welcome message received', 'client');\n          this.emit('welcome', message as any);\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n          if (this.options.onWelcome) {\n            this.options.onWelcome(message as any);\n          }\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ ping/pong\n        if (message.type === 'ping') {\n          logger.info('üèì Ping received from server', 'client');\n          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º pong –≤ –æ—Ç–≤–µ—Ç\n          this.sendPong();\n          return;\n        }\n        \n        if (message.type === 'pong') {\n          this.handlePong();\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∫–æ–º–Ω–∞—Ç–∞—Ö –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n        if (message.type === 'room_joined') {\n          logger.info('üè† Room joined message received', 'client');\n          this.emit('join_room', { roomId: message.room_id, timestamp: Date.now() });\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n          if (this.options.onJoinRoom) {\n            this.options.onJoinRoom({ roomId: message.room_id, timestamp: Date.now() });\n          }\n          return;\n        }\n        \n        if (message.type === 'room_left') {\n          logger.info('üö™ Room left message received', 'client');\n          this.emit('leave_room', { roomId: message.room_id, timestamp: Date.now() });\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n          if (this.options.onLeaveRoom) {\n            this.options.onLeaveRoom({ roomId: message.room_id, timestamp: Date.now() });\n          }\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–º–Ω–∞—Ç–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n        if (message.type === 'room_message') {\n          logger.info('üì® Room message received', 'client');\n          this.emit('message', message);\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–º–Ω–∞—Ç–µ\n          if (this.options.onRoomMessage) {\n            this.options.onRoomMessage(message as any);\n          }\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n        if (message.type === 'message_ack') {\n          logger.info('‚úÖ Message acknowledgment received', 'client');\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n          if (this.options.onMessageAck) {\n            this.options.onMessageAck(message as any);\n          }\n          \n          // –ù–µ –≤—ã–∑—ã–≤–∞–µ–º onMessage –¥–ª—è —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n          return;\n        }\n        \n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä—è–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n        if (message.type === 'direct_message') {\n          logger.info('üì® Direct message received', 'client');\n          this.emit('message', message);\n          \n          // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—Ä—è–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n          if (this.options.onDirectMessage) {\n            this.options.onDirectMessage(message as any);\n          }\n          return;\n        }\n        \n        // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n        if (this.options.onMessage) {\n          const wsEvent: WebSocketEvent = {\n            type: 'message',\n            data: message,\n            timestamp: Date.now()\n          };\n          this.options.onMessage(wsEvent);\n        }\n        \n        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ message\n        this.emit('message', message);\n      } catch (error) {\n        logger.error(`‚ùå Error parsing message: ${error}`, 'client');\n      }\n    };\n\n    this.ws.onerror = (error) => {\n      this.isConnecting = false;\n      logger.error(`‚ùå WebSocket error: ${error}`, 'client');\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onError) {\n        const wsEvent: WebSocketEvent = {\n          type: 'error',\n          data: { error: error.toString() },\n          timestamp: Date.now()\n        };\n        this.options.onError(wsEvent);\n      }\n      \n      reject(new Error(`WebSocket connection failed: ${error}`));\n    };\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è\n   */\n  send(data: any, roomId?: string): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    try {\n      const message: WebSocketMessage = {\n        type: 'message',\n        data,\n        timestamp: new Date().toISOString(),\n        roomId: roomId || this.currentRoom || undefined\n      };\n\n      this.ws.send(JSON.stringify(message));\n      logger.debug(`üì§ Message sent: ${JSON.stringify(data).substring(0, 100)}...`, 'client');\n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error sending message: ${error}`, 'client');\n      return false;\n    }\n  }\n\n  /**\n   * –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ\n   */\n  joinRoom(roomId: string): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    try {\n      const message: WebSocketMessage = {\n        type: 'join_room',\n        data: { roomId },\n        timestamp: new Date().toISOString()\n      };\n\n      this.ws.send(JSON.stringify(message));\n      this.currentRoom = roomId;\n      \n      logger.info(`üîó Joined room: ${roomId}`, 'client');\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ\n      this.emit('join_room', { roomId, timestamp: Date.now() });\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onJoinRoom) {\n        this.options.onJoinRoom({ roomId, timestamp: Date.now() });\n      }\n      \n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error joining room: ${error}`, 'client');\n      return false;\n    }\n  }\n\n  /**\n   * –í—ã—Ö–æ–¥ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã\n   */\n  leaveRoom(roomId?: string): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    const targetRoom = roomId || this.currentRoom;\n    if (!targetRoom) {\n      logger.warn('‚ö†Ô∏è Not in any room', 'client');\n      return false;\n    }\n\n    try {\n      const message: WebSocketMessage = {\n        type: 'leave_room',\n        data: { roomId: targetRoom },\n        timestamp: new Date().toISOString()\n      };\n\n      this.ws.send(JSON.stringify(message));\n      \n      if (targetRoom === this.currentRoom) {\n        this.currentRoom = null;\n      }\n      \n      logger.info(`üö™ Left room: ${targetRoom}`, 'client');\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ\n      this.emit('leave_room', { roomId: targetRoom, timestamp: Date.now() });\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onLeaveRoom) {\n        this.options.onLeaveRoom({ roomId: targetRoom, timestamp: Date.now() });\n      }\n      \n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error leaving room: ${error}`, 'client');\n      return false;\n    }\n  }\n\n  /**\n   * –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n   */\n  disconnect(): void {\n    logger.info('üîå Disconnecting from WebSocket server', 'client');\n    \n    this.stopPingPong();\n    this.cancelReconnect();\n    \n    if (this.ws) {\n      this.ws.close(1000, 'Client disconnect');\n      this.ws = null;\n    }\n    \n    this.isConnecting = false;\n    this.isReconnecting = false;\n    this.currentRoom = null;\n  }\n\n  /**\n   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n   */\n  getState(): number {\n    return this.ws ? this.ws.readyState : WebSocket.CLOSED;\n  }\n\n  /**\n   * –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n   */\n  isConnected(): boolean {\n    return this.ws ? this.ws.readyState === WebSocket.OPEN : false;\n  }\n\n  /**\n   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–º–Ω–∞—Ç—ã\n   */\n  getCurrentRoom(): string | null {\n    return this.currentRoom;\n  }\n\n  /**\n   * –ó–∞–ø—É—Å–∫ ping/pong –º–µ—Ö–∞–Ω–∏–∑–º–∞\n   */\n  private startPingPong(): void {\n    if (!this.pingPongConfig.enabled) return;\n    \n    this.pingTimer = setInterval(() => {\n      this.sendPing();\n    }, this.pingPongConfig.interval);\n  }\n\n  /**\n   * –û—Å—Ç–∞–Ω–æ–≤–∫–∞ ping/pong –º–µ—Ö–∞–Ω–∏–∑–º–∞\n   */\n  private stopPingPong(): void {\n    if (this.pingTimer) {\n      clearInterval(this.pingTimer);\n      this.pingTimer = null;\n    }\n    \n    if (this.pongTimer) {\n      clearTimeout(this.pongTimer);\n      this.pongTimer = null;\n    }\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ ping\n   */\n  private sendPing(): void {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) return;\n    \n    try {\n      const pingMessage: WebSocketMessage = {\n        type: 'ping',\n        data: { timestamp: new Date().toISOString() },\n        timestamp: new Date().toISOString()\n      };\n      \n      this.ws.send(JSON.stringify(pingMessage));\n      this.pingPongConfig.lastPing = Date.now();\n      \n      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç –¥–ª—è pong\n      this.pongTimer = setTimeout(() => {\n        logger.warn('‚ö†Ô∏è Pong timeout, connection may be stale', 'client');\n        this.ws?.close(1000, 'Pong timeout');\n      }, this.pingPongConfig.timeout);\n      \n      logger.debug('üèì Ping sent', 'client');\n      \n      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ ping\n      this.emit('ping', { timestamp: this.pingPongConfig.lastPing });\n      \n      // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n      if (this.options.onPing) {\n        this.options.onPing({ timestamp: this.pingPongConfig.lastPing });\n      }\n    } catch (error) {\n      logger.error(`‚ùå Error sending ping: ${error}`, 'client');\n    }\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ pong –≤ –æ—Ç–≤–µ—Ç –Ω–∞ ping –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞\n   */\n  private sendPong(): void {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) return;\n    \n    try {\n      const pongMessage: WebSocketMessage = {\n        type: 'pong',\n        data: { timestamp: new Date().toISOString() },\n        timestamp: new Date().toISOString()\n      };\n      \n      this.ws.send(JSON.stringify(pongMessage));\n      logger.debug('üèì Pong sent to server', 'client');\n    } catch (error) {\n      logger.error(`‚ùå Error sending pong: ${error}`, 'client');\n    }\n  }\n\n  /**\n   * –û–±—Ä–∞–±–æ—Ç–∫–∞ pong\n   */\n  private handlePong(): void {\n    this.pingPongConfig.lastPong = Date.now();\n    \n    if (this.pongTimer) {\n      clearTimeout(this.pongTimer);\n      this.pongTimer = null;\n    }\n    \n    const latency = this.pingPongConfig.lastPong - this.pingPongConfig.lastPing;\n    logger.debug(`üèì Pong received, latency: ${latency}ms`, 'client');\n    \n    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ pong\n    this.emit('pong', { latency, timestamp: this.pingPongConfig.lastPong });\n    \n    // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n    if (this.options.onPong) {\n      this.options.onPong({ latency, timestamp: this.pingPongConfig.lastPong });\n    }\n  }\n\n  /**\n   * –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n   */\n  private scheduleReconnect(): void {\n    if (this.reconnectConfig.currentAttempt >= this.reconnectConfig.maxAttempts) {\n      logger.error(`‚ùå Max reconnection attempts reached (${this.reconnectConfig.maxAttempts})`, `client`);\n      return;\n    }\n    \n    this.isReconnecting = true;\n    this.reconnectConfig.currentAttempt++;\n    \n    const delay = this.reconnectConfig.interval * Math.pow(2, this.reconnectConfig.currentAttempt - 1);\n    logger.info(`üîÑ Reconnecting in ${delay}ms (attempt ${this.reconnectConfig.currentAttempt}/${this.reconnectConfig.maxAttempts})`, 'client');\n    \n    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ reconnect\n    this.emit('reconnect', {\n      attempt: this.reconnectConfig.currentAttempt,\n      maxAttempts: this.reconnectConfig.maxAttempts,\n      delay,\n      timestamp: Date.now()\n    });\n    \n    // –í—ã–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫\n    if (this.options.onReconnect) {\n      this.options.onReconnect({\n        attempt: this.reconnectConfig.currentAttempt,\n        maxAttempts: this.reconnectConfig.maxAttempts,\n        delay,\n        timestamp: Date.now()\n      });\n    }\n    \n    this.reconnectTimer = setTimeout(() => {\n      this.connect().catch((error) => {\n        logger.error(`‚ùå Reconnection failed: ${error}`, 'client');\n        this.scheduleReconnect();\n      });\n    }, delay);\n  }\n\n  /**\n   * –û—Ç–º–µ–Ω–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n   */\n  private cancelReconnect(): void {\n    if (this.reconnectTimer) {\n      clearTimeout(this.reconnectTimer);\n      this.reconnectTimer = null;\n    }\n    this.isReconnecting = false;\n  }\n\n  /**\n   * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏\n   */\n  updateOptions(newOptions: Partial<WebSocketOptions>): void {\n    this.options = { ...this.options, ...newOptions };\n    \n    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è\n    if (newOptions.autoReconnect !== undefined) {\n      this.reconnectConfig.enabled = newOptions.autoReconnect;\n    }\n    if (newOptions.reconnectAttempts !== undefined) {\n      this.reconnectConfig.maxAttempts = newOptions.reconnectAttempts;\n    }\n    if (newOptions.reconnectDelay !== undefined) {\n      this.reconnectConfig.interval = newOptions.reconnectDelay;\n    }\n    \n    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é ping/pong\n    if (newOptions.pingInterval !== undefined) {\n      this.pingPongConfig.interval = newOptions.pingInterval;\n    }\n    if (newOptions.pongTimeout !== undefined) {\n      this.pingPongConfig.timeout = newOptions.pongTimeout;\n    }\n    \n    logger.info('üîß WebSocket options updated', 'client');\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–æ–º–Ω–∞—Ç—É\n   */\n  sendToRoom(roomId: string, message: any): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    try {\n      const wsMessage: WebSocketMessage = {\n        type: 'room_message',\n        data: message,\n        timestamp: new Date().toISOString(),\n        roomId: roomId\n      };\n\n      this.ws.send(JSON.stringify(wsMessage));\n      logger.debug(`üì§ Room message sent to ${roomId}: ${JSON.stringify(message).substring(0, 100)}...`, 'client');\n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error sending room message: ${error}`, 'client');\n      return false;\n    }\n  }\n\n  /**\n   * –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä—è–º–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—É –ø–æ ID\n   */\n  sendDirectMessage(clientId: string, message: any): boolean {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      logger.error('‚ùå WebSocket not connected', 'client');\n      return false;\n    }\n\n    try {\n      const wsMessage: WebSocketMessage = {\n        type: 'direct_message',\n        data: message,\n        timestamp: new Date().toISOString(),\n        targetClientId: clientId\n      };\n\n      this.ws.send(JSON.stringify(wsMessage));\n      logger.debug(`üì§ Direct message sent to client ${clientId}: ${message}`, 'client');\n      return true;\n    } catch (error) {\n      logger.error(`‚ùå Error sending direct message: ${error}`, 'client');\n      return false;\n    }\n  }\n}\n","import { RNodeWebSocketClient } from './client';\nimport { Logger, LogLevel } from './logger';\nimport type {\n  WebSocketOptions,\n  WebSocketEvent,\n  WebSocketMessage,\n  RoomInfo,\n  ConnectionInfo,\n  ReconnectConfig,\n  PingPongConfig\n} from './types';\n\n// –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\nexport function createWebSocketClient(options: WebSocketOptions) {\n  return new RNodeWebSocketClient(options);\n}\n\n// –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å WebSocket\nexport const WebSocketUtils = {\n  /**\n   * –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ WebSocket –≤ –±—Ä–∞—É–∑–µ—Ä–µ\n   */\n  isSupported(): boolean {\n    return typeof WebSocket !== 'undefined';\n  },\n\n  /**\n   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ\n   */\n  getStateString(state: number): string {\n    switch (state) {\n      case WebSocket.CONNECTING:\n        return 'CONNECTING';\n      case WebSocket.OPEN:\n        return 'OPEN';\n      case WebSocket.CLOSING:\n        return 'CLOSING';\n      case WebSocket.CLOSED:\n        return 'CLOSED';\n      default:\n        return 'UNKNOWN';\n    }\n  },\n\n  /**\n   * –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞\n   */\n  generateClientId(): string {\n    return `client_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  },\n\n  /**\n   * –í–∞–ª–∏–¥–∞—Ü–∏—è URL WebSocket\n   */\n  isValidUrl(url: string): boolean {\n    try {\n      const urlObj = new URL(url);\n      return urlObj.protocol === 'ws:' || urlObj.protocol === 'wss:';\n    } catch {\n      return false;\n    }\n  }\n};\n\n// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ\nif (typeof window !== 'undefined') {\n  // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å WebSocket –∫–ª–∏–µ–Ω—Ç–∞ - —É–±–∏—Ä–∞–µ–º –¥–≤–æ–π–Ω—É—é –æ–±–µ—Ä—Ç–∫—É\n  (window as any).RNodeWebSocketClient = RNodeWebSocketClient;\n  \n  // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞\n  (window as any).createWebSocketClient = createWebSocketClient;\n  \n  // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã\n  (window as any).WebSocketUtils = WebSocketUtils;\n  \n  // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ª–æ–≥–≥–µ—Ä\n  (window as any).WebSocketLogger = Logger;\n  (window as any).WebSocketLogLevel = LogLevel;\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∞—Å—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä\n  console.log('üîå RNode WebSocket Client –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ');\n  console.log('üìñ –î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:');\n  console.log('   - window.RNodeWebSocketClient:', typeof (window as any).RNodeWebSocketClient);\n  console.log('   - window.createWebSocketClient():', typeof (window as any).createWebSocketClient);\n  console.log('   - window.WebSocketUtils:', typeof (window as any).WebSocketUtils);\n  console.log('   - window.WebSocketLogger:', typeof (window as any).WebSocketLogger);\n  \n  // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞\n  try {\n    const testClient = new (window as any).RNodeWebSocketClient({ url: 'ws://test' });\n    console.log('‚úÖ RNodeWebSocketClient —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∫–∞–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä');\n  } catch (error) {\n    console.error('‚ùå RNodeWebSocketClient –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º:', error);\n  }\n}\n\n// –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –º–æ–¥—É–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º\nexport {\n  RNodeWebSocketClient,\n  Logger,\n  LogLevel\n};\n"],"names":["LogLevel"],"mappings":"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"}